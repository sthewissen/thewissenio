---
layout: post
title: Crash Reporting and Analytics for Xamarin
wordpress_id: 670
wordpress_url: https://www.thewissen.io/?p=670
date: '2017-07-14 21:58:23 +0200'
date_gmt: '2017-07-14 19:58:23 +0200'
categories:
- Code
tags:
- xamarin
- analytics
---

<p>Knowing what your app is doing after you've released it into the wild is very important. When it comes to Xamarin there are several products that offer functionality such as crash reporting and analytics.. So what should you be using these days?<br></p>

<p><!-- wp:more -->
<!--more-->
<!-- /wp:more --></p>
<p><!-- wp:quote --></p>
<blockquote class="wp-block-quote"><p><strong>Note:</strong> If you're still reading this today, you should now that what is referred to here as Mobile Center is now officially called AppCenter. Please take some of the information in this post with a grain of salt as some of it might be outdated.</p>
</blockquote>
<p><!-- /wp:quote --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3>What used to be</h3>
<p>For a while Xamarin offered their own solution called Xamarin Insights. This looked great and gave you the ability to view crashes and define events in your app that you could analyze to your heart's content. These events gave you insights into how much different parts of your app were being used. However Xamarin Insights has been on the fringe for over a year now as <a href="https://www.xamarin.com/insights" target="_blank" rel="noopener noreferrer">their own page</a> will tell you without hesitation.</p>

<p><!-- wp:image {"align":"center","id":675,"linkDestination":"custom"} --></p>
<div class="wp-block-image">
<figure class="aligncenter"><a href="/images/posts/insights.png" target="_blank" rel="noopener noreferrer"><img src="/images/posts/insights-700x322.png" alt="Insights is moving to HockeyApp" class="wp-image-675"/></a></figure>
</div>

<p>They're joining <a href="https://www.hockeyapp.net/" target="_blank" rel="noopener noreferrer">HockeyApp</a> which is great news! HockeyApp is a platform that lets you distribute test versions of your application along with metrics and crash reporting. Even though their analytics side isn't as good looking as Insights it still sounds fun! Except for the fact that HockeyApp itself is also going to be shutting down at some point while they're getting ready for what they're calling the next generation HockeyApp: <a href="https://mobile.azure.com/" target="_blank" rel="noopener noreferrer">Mobile Center</a>.</p>

<p><!-- wp:image {"align":"center","id":678,"linkDestination":"custom"} --></p>
<div class="wp-block-image">
<figure class="aligncenter"><a href="/images/posts/hockeyapp.png" target="_blank" rel="noopener noreferrer"><img src="/images/posts/hockeyapp-700x288.png" alt="HockeyApp is moving along to Mobile Center" class="wp-image-678"/></a></figure>
</div>

<h3>What should I be using today?</h3>
<p>As described in the previous paragraph two of the tools people have been using are going away sometime in the future and a new contender for the crown has already been introduced by Microsoft. Having two products (HockeyApp and Xamarin Insights) for the same kind of functionality means its only logical to replace them however Mobile Center is more than the sum of its parts. It lets you connect to your VSTS instance and build your apps as well. It is less configurable than your own VSTS build pipeline though.</p>


<p>Some of the current features of Mobile Center:</p>
<ul>
<li>Automatically build your app (e.g. on commit to a specific branch)</li>
<li>Test it on real devices using Xamarin Test Cloud (you can add your existing subscription)</li>
<li>Distribute it to beta testers in different distribution groups or production environments (AppStore, Play Store, InTune)</li>
<li>Collect crash reports and user analytics, including custom events</li>
<li>Add cloud-based user authentication and table storage in minutes</li>
<li>Push notifications with support for different audiences</li>
</ul>
<p>As you can see it's quite the elaborate tool already and it's pretty much a one-stop mission control for your app. Since it's still in active development and constantly evolving it will most likely only get better.</p>

<h3>Let's focus on crash reporting</h3>
<p>Since the basic idea of this post is getting some decent crash reporting we will zoom into that part of Mobile Center for now. It's pretty simple to set up so feel free to experiment with all the other features it offers. The first thing we need is to <em>define our app </em>which we do by going up to <strong>New App</strong> and filling in the required fields. As you can see Mobile Center also supports native apps made in Java, Swift or Objective-C. You can also see that HockeyApp is still very much alive in spirit by the <em>"This new app will not appear in HockeyApp"</em> message at the top.</p>

<p><!-- wp:image {"align":"center","id":686,"linkDestination":"custom"} --></p>
<div class="wp-block-image">
<figure class="aligncenter"><a href="/images/posts/demo.png" target="_blank" rel="noopener noreferrer"><img src="/images/posts/demo-700x356.png" alt="Creating a new app" class="wp-image-686"/></a></figure>
</div>

<p>After creating the app definition there are only a few more steps that separate you from getting awesome stats.</p>

<p><!-- wp:list {"ordered":true} --></p>
<ol>
<li>First of all you should be <em>adding a few NuGet packages</em> to your portable project and your platform specific projects which are the&nbsp;<code>Mobile Center</code>, <code>Mobile Center Analytics</code> and <code>Mobile Center Crashes</code>&nbsp;packages.</li>
<li>Add the following using statements to your <code>App.xaml.cs</code>.
<code>using Microsoft.Azure.Mobile; <br>
using Microsoft.Azure.Mobile.Analytics;<br>
using Microsoft.Azure.Mobile.Crashes;</code>
</li>
<li>Next up we need to let Mobile Center know that you want to start tracking. The line below goes in the <code>OnStart()</code> method in the <code>App.xaml.cs</code>. Don't forget to fill in the secret keys that Mobile Center gives you as soon as you create an app for each of the platforms you require.<br><br>
<code>MobileCenter.Start("ios={You iOS App secret here}};" +
                   "uwp={Your UWP App secret here};" +
                   "android={Your Android App secret here}",
                   typeof(Analytics), typeof(Crashes));</code>
</li>
</ol>
<p>And that's it. You're set to receive crash reports for your Xamarin Forms app. You can start generating crashes and the data you will receive will look something like the sample below. As you can see you can view things like the stack trace, affected devices, crash rate and the version of the app the problem occurred in. Very useful information!</p>

<p><!-- wp:image {"align":"center","id":694,"linkDestination":"custom"} --></p>
<div class="wp-block-image">
<figure class="aligncenter"><a href="/images/posts/error.png" target="_blank" rel="noopener noreferrer"><img src="/images/posts/error-700x355.png" alt="An error logged in Mobile Center" class="wp-image-694"/></a></figure>
</div>

<h3>App usage</h3>
<p>As soon as you've implemented the call to the Mobile Center SDK you also get usage information for free. In the Analytics section of Mobile Center you can view such statistics as:</p>
<ul>
<li># of active users and daily sessions per user</li>
<li>Session duration</li>
<li>Top devices</li>
<li>Countries and languages used</li>
<li>Version distribution amongst users</li>
</ul>
<p>You don't have to do anything else to get this information and it can be quite crucial to making decisions about the future of your app. If you see a lot of users have a foreign language that you're not supporting yet then it might be worth investing in adding that language.</p>

<p><!-- wp:image {"align":"center","id":699,"linkDestination":"custom"} --></p>
<div class="wp-block-image">
<figure class="aligncenter"><a href="/images/posts/events.png"><img src="/images/posts/events-700x354.png" alt="Basic stats about your app" class="wp-image-699"/></a></figure>
</div>

<h3>What about events?</h3>
<p>Earlier in this post, I said you could also trace events throughout your app which can be defined by a single line of code. However, you are limited in what you are able to track. Currently, you can only track 200 unique events in your app and each event can have a payload that can contain a maximum of 5 custom properties. Note that there is a maximum of 256 characters supported per event name and 64 characters per event property name and event property value name. This is ideal when you need to have a bit more information about the event e.g. who triggered it. To log an event you can use the following line in your code:</p>


<p><code>Analytics.TrackEvent("My very own event", new Dictionary<string, string> { { "User", "sthewissen" }, { "HasWifi", true });</code></p>


<p>When you've implemented your events you can view them as soon as they occur in the Mobile Center events section. You get detailed statistics about their rate of occurrence per user or per session. You also get statistics based on the custom payload you provided. Using the sample above you would be able to get information about the percentage of users that HasWiFi was true for (100% in the sample :)).</p>

<p><!-- wp:image {"align":"center","id":698,"linkDestination":"custom"} --></p>
<div class="wp-block-image">
<figure class="aligncenter"><a href="/images/posts/events2.png" target="_blank" rel="noopener noreferrer"><img src="/images/posts/events2-700x353.png" alt="Events-based stats in your app" class="wp-image-698"/></a></figure>
</div>

<h3>Conclusion</h3>
<p>Mobile Center is a great stand-in for Xamarin Insights and provides more analytical information than HockeyApp does at this point. Microsoft is actively improving Mobile Center which means that new functionality is added on a regular basis. Installation in your app is a breeze so there's no excuse to not switch over to Mobile Center to get your analytics fix.</p>

